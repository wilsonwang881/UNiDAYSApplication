<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=yes">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="css/bootstrap.min.css">

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="js/jquery-3.3.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="js/bootstrap.min.js"></script>

    <title>Price Calculator</title>

    <script>
    var item = [];
    var shoppingCart = [];

    var defaultPricingRule = {
      A: {price: 8,
          discount: "none"},
      B: {price: 12,
          discount: "2 cost 20"},
      C: {price: 4,
          discount: "3 cost 10"},
      D: {price: 7,
          discount: "1 free 1"},
      E: {price: 5,
          discount: "3 for 2"}
    };

    function callCheckObj(){
      checkType(defaultPricingRule);
    }

    function checkType(obj){
      console.log(typeof obj);
      let rules = new UnidaysDiscountChallenge(defaultPricingRule);
      return typeof obj;
    }

    class UnidaysDiscountChallenge  {
      constructor(pricingRules) {
        this.total = 0;
        this.deliveryCharge = 0;
        this.pricingRules = pricingRules;
        this.basket = {};

        for(var key in this.pricingRules) {
          this.basket[key] = 0;
        }

        console.log(this.basket);
      }

      total() {
        return this.total;
      }

      deliveryCharge() {
        return this.deliveryCharge;
      }

      basket() {
        return this.basket;
      }

      addToBasket(item) {
        try {
          this.basket[item] += 1;
        }
        catch(err) {
          alert("Item does not exist");
        }
        console.log(this.basket);
      }

      removeFromBasket(item) {
        try {
          if(this.basket[item]>0){
            this.basket[item] -= 1;
          }
          else{
            this.basket[item] = 0;
          }
        }
        catch(err) {
          alert("Item does not exist");
        }
      }

      calculateTotalPrice() {
        this.total = 0;

        for(var key in this.basket) {
          if(this.basket[key]>0){
            this.total += interpretPricingPolicy(key, this.basket[key]);
          }
        }
      }

      interpretPricingPolicy(item, amount) {
        var price = this.pricingRules[key]["price"];

        if(this.pricingRules[key]["discount"]=="none"){
          return price*amount;
        }
        else{
          var policy = this.pricingRules[key]["discount"].split(" ");

          switch (policy[1]) {
            case "cost":

              break;
            case "free":

              break;
            case "for":

              break;
            default:
              break;
          }
        }
      }
    }

    $(document).ready(function () {
      $("#showCalculator").click(function () {
        $("#pricing-rules-div").attr("style", "display: none");
        $("#calculator-div").attr("style", "display: block");
      });

      $("#showPricingRules").click(function (){
        $("#pricing-rules-div").attr("style", "display: block");
        $("#calculator-div").attr("style", "display: none");
      });
    });

    </script>
  </head>

  <body>
    <div class="container-fluid" style="width: 85%; height: 95%;">
      <div class="h-25 d-inline-block">
      </div>
      <h2>UNiDAYS Discount Challenge</h2>
      <div class="col-xs-12" style="height:20px;"></div>
      <div class="row">
        <div class="col-2">
          <button id="showCalculator" type="button" class="btn btn-default">Calculator</button>
          <div class="col-xs-12" style="height:15px;"></div>
          <button id="showPricingRules" type="button" class="btn btn-default">Pricing Rules</button>
        </div>
        <div class="col-1">
        </div>
        <div class="col-9">
          <div id="calculator-div" style="display: block;">
            <div class="row">
              <div class="col-7">
                <h3>Items</h3>
                <div class="row">
                  <input type="text" class="form-control" style="width: 70%;">
                  <button class="btn btn-default" onclick="callCheckObj()">Get price</button>
                </div>
              </div>
              <div class="col-2">
                <h4>Summary</h4>
                <hr size="5" id="belowSummary" style="display: none;">
                <div id="itemNone" style="display: block"></div>
                <div id="itemA" style="display: none;"></div>
                <div id="itemB" style="display: none;"></div>
                <div id="itemC" style="display: none;"></div>
                <div id="itemD" style="display: none;"></div>
                <div id="itemE" style="display: none;"></div>
                <div id="itemF" style="display: none;"></div>
                <hr size="5">
                <h5>Delivery</h5>
                <h6>£0.00</h6>
                <h5>Total</h5>
                <h6>£0.00</h6>
              </div>
            </div>
          </div>
          <div id="pricing-rules-div" style="display: none;">
            <h1>Hidden content</h1>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
